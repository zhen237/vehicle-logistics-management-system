import{_ as xe,r as k,a7 as we,o as $e,a as $,b as p,c as t,k as s,g as r,T as F,w as a,C as Te,d as Re,e as f,f as Oe,aj as he,j as Ee,U as Le,V as be,B as Se,ak as De,a2 as Me,P as Ye,S as Be,ao as Ie,aM as q,av as Ue,m as ze,p as M,q as G,t as v,s as He,W as Ae,a3 as Ke,a4 as J,a5 as Ne,a6 as Ve,ap as Pe,ag as je,A as Fe,z as qe,G as Ge,a9 as Je,aN as Qe,K as o,a8 as Y}from"./index-BK7oz1s9.js";import{U as We}from"./UserAddOutlined-Bw9b1CUG.js";const Xe={class:"role-management"},Ze={class:"page-header"},et=["onClick"],tt=["onClick"],at=["onClick"],lt=["onClick"],st=["onClick"],nt=["onClick"],ot={key:0,class:"role-detail"},ut={class:"role-header"},it={class:"role-info"},dt={class:"role-stats"},_t={class:"role-actions"},rt={key:1,class:"no-selection"},ct={__name:"Roles",setup(pt){const O=k(""),E=k(""),L=k(""),B=k(!1),c=k([]),d=k(null),T=k({current:1,pageSize:10,total:0,showSizeChanger:!0,showQuickJumper:!0,showTotal:(l,e)=>`第 ${e[0]}-${e[1]} 条，共 ${l} 条`}),m=k([{id:"ROLE001",name:"超级管理员",code:"super_admin",description:"系统超级管理员，拥有所有权限",type:"系统角色",status:"启用",userCount:1,permissionCount:50,createTime:"2024-01-01 00:00:00",updateTime:"2024-01-01 00:00:00",creator:"系统",key:"ROLE001"},{id:"ROLE002",name:"系统管理员",code:"system_admin",description:"系统管理员，负责系统配置和用户管理",type:"系统角色",status:"启用",userCount:2,permissionCount:35,createTime:"2024-01-01 00:00:00",updateTime:"2024-06-15 10:30:00",creator:"超级管理员",key:"ROLE002"},{id:"ROLE003",name:"调度管理员",code:"dispatch_admin",description:"调度管理员，负责车辆调度和运输管理",type:"业务角色",status:"启用",userCount:5,permissionCount:25,createTime:"2024-02-01 09:00:00",updateTime:"2024-06-20 14:20:00",creator:"系统管理员",key:"ROLE003"},{id:"ROLE004",name:"财务管理员",code:"finance_admin",description:"财务管理员，负责财务数据和薪资管理",type:"业务角色",status:"启用",userCount:3,permissionCount:20,createTime:"2024-02-01 09:00:00",updateTime:"2024-06-18 16:45:00",creator:"系统管理员",key:"ROLE004"},{id:"ROLE005",name:"人事管理员",code:"hr_admin",description:"人事管理员，负责员工管理和考勤管理",type:"业务角色",status:"启用",userCount:2,permissionCount:18,createTime:"2024-02-01 09:00:00",updateTime:"2024-06-22 11:15:00",creator:"系统管理员",key:"ROLE005"},{id:"ROLE006",name:"普通用户",code:"normal_user",description:"普通用户，只能查看基本信息",type:"自定义角色",status:"启用",userCount:15,permissionCount:8,createTime:"2024-03-01 10:00:00",updateTime:"2024-06-25 09:30:00",creator:"系统管理员",key:"ROLE006"},{id:"ROLE007",name:"测试角色",code:"test_role",description:"测试用角色，用于功能测试",type:"自定义角色",status:"禁用",userCount:0,permissionCount:5,createTime:"2024-06-01 15:00:00",updateTime:"2024-06-01 15:00:00",creator:"系统管理员",key:"ROLE007"}]),b=k({total:m.value.length,active:m.value.filter(l=>l.status==="启用").length,system:m.value.filter(l=>l.type==="系统角色").length,custom:m.value.filter(l=>l.type==="自定义角色").length}),Q=[{title:"角色名称",dataIndex:"name",key:"name",width:150},{title:"角色编码",dataIndex:"code",key:"code",width:150},{title:"角色类型",dataIndex:"type",key:"type",width:120},{title:"状态",dataIndex:"status",key:"status",width:100},{title:"用户数量",dataIndex:"userCount",key:"userCount",width:100},{title:"权限数量",dataIndex:"permissionCount",key:"permissionCount",width:100},{title:"创建时间",dataIndex:"createTime",key:"createTime",width:150},{title:"操作",key:"actions",width:250,fixed:"right"}],W=we(()=>{let l=m.value;if(O.value){const e=O.value.toLowerCase();l=l.filter(u=>u.name.toLowerCase().includes(e)||u.code.toLowerCase().includes(e)||u.description.toLowerCase().includes(e))}return E.value&&(l=l.filter(e=>e.status===E.value)),L.value&&(l=l.filter(e=>e.type===L.value)),T.value.total=l.length,l}),U=l=>({启用:"green",禁用:"red"})[l]||"default",I=l=>({系统角色:"purple",业务角色:"blue",自定义角色:"orange"})[l]||"default",X=l=>l?Y(l).format("YYYY-MM-DD HH:mm"):"-",Z=l=>{O.value=l,T.value.current=1},z=()=>{T.value.current=1},ee=()=>{B.value=!0,setTimeout(()=>{B.value=!1,o.success("数据已刷新")},1e3)},te=()=>{o.success("角色数据导出成功")},ae=()=>{o.info("打开新增角色弹窗")},le=l=>{c.value=l},se=l=>{T.value={...T.value,...l}},ne=l=>{d.value=l,o.info(`查看角色详情: ${l.name}`)},oe=l=>{o.info(`编辑角色: ${l.name}`)},H=l=>{o.info(`配置角色权限: ${l.name}`)},A=l=>{o.info(`分配用户到角色: ${l.name}`)},ue=l=>{o.info(`查看角色用户: ${l.name}`)},ie=l=>{o.info(`查看角色权限: ${l.name}`)},de=l=>{o.success(`角色 ${l.name} 已复制`)},_e=l=>{o.success(`角色 ${l.name} 导出成功`)},K=l=>{o.info(`查看角色审计日志: ${l.name}`)},re=l=>{const e=l.status==="启用"?"禁用":"启用";l.status=e,l.updateTime=Y().format("YYYY-MM-DD HH:mm:ss"),o.success(`角色 ${l.name} 已${e}`)},ce=l=>{const e=m.value.findIndex(u=>u.id===l.id);e>-1&&(m.value.splice(e,1),o.success(`角色 ${l.name} 已删除`))},pe=()=>{c.value.forEach(l=>{const e=m.value.find(u=>u.key===l);e&&(e.status="启用",e.updateTime=Y().format("YYYY-MM-DD HH:mm:ss"))}),o.success(`批量启用 ${c.value.length} 个角色`),c.value=[]},me=()=>{c.value.forEach(l=>{const e=m.value.find(u=>u.key===l);e&&e.type!=="系统角色"&&(e.status="禁用",e.updateTime=Y().format("YYYY-MM-DD HH:mm:ss"))}),o.success(`批量禁用 ${c.value.length} 个角色`),c.value=[]},ve=()=>{o.success(`批量导出 ${c.value.length} 个角色`),c.value=[]},fe=()=>{const l=c.value.filter(e=>{const u=m.value.find(_=>_.key===e);return u&&u.type!=="系统角色"});l.forEach(e=>{const u=m.value.findIndex(_=>_.key===e);u>-1&&m.value.splice(u,1)}),o.success(`批量删除 ${l.length} 个角色`),c.value=[]};return $e(()=>{}),(l,e)=>{const u=he,_=Oe,x=be,N=Le,h=Ee,C=Se,S=Re,w=Te,R=Be,g=Ve,V=Ne,P=Ke,D=He,ye=Pe,ke=ze,Ce=Fe,j=Ge,ge=Qe;return f(),$("div",Xe,[p("div",Ze,[p("h1",null,[t(r(F)),e[6]||(e[6]=s(" 角色管理 "))]),e[7]||(e[7]=p("p",null,"管理系统角色，配置权限分配，确保系统安全有序运行",-1))]),t(w,{class:"toolbar-card"},{default:a(()=>[t(S,{gutter:[16,16],align:"middle"},{default:a(()=>[t(_,{xs:24,sm:12,md:8},{default:a(()=>[t(u,{value:O.value,"onUpdate:value":e[0]||(e[0]=i=>O.value=i),placeholder:"搜索角色名称、描述",onSearch:Z,style:{width:"100%"}},null,8,["value"])]),_:1}),t(_,{xs:24,sm:12,md:8},{default:a(()=>[t(h,null,{default:a(()=>[t(N,{value:E.value,"onUpdate:value":e[1]||(e[1]=i=>E.value=i),placeholder:"角色状态",style:{width:"120px"},onChange:z},{default:a(()=>[t(x,{value:""},{default:a(()=>e[8]||(e[8]=[s("全部状态")])),_:1,__:[8]}),t(x,{value:"启用"},{default:a(()=>e[9]||(e[9]=[s("启用")])),_:1,__:[9]}),t(x,{value:"禁用"},{default:a(()=>e[10]||(e[10]=[s("禁用")])),_:1,__:[10]})]),_:1},8,["value"]),t(N,{value:L.value,"onUpdate:value":e[2]||(e[2]=i=>L.value=i),placeholder:"角色类型",style:{width:"120px"},onChange:z},{default:a(()=>[t(x,{value:""},{default:a(()=>e[11]||(e[11]=[s("全部类型")])),_:1,__:[11]}),t(x,{value:"系统角色"},{default:a(()=>e[12]||(e[12]=[s("系统角色")])),_:1,__:[12]}),t(x,{value:"业务角色"},{default:a(()=>e[13]||(e[13]=[s("业务角色")])),_:1,__:[13]}),t(x,{value:"自定义角色"},{default:a(()=>e[14]||(e[14]=[s("自定义角色")])),_:1,__:[14]})]),_:1},8,["value"])]),_:1})]),_:1}),t(_,{xs:24,sm:24,md:8,class:"text-right"},{default:a(()=>[t(h,null,{default:a(()=>[t(C,{onClick:ee},{default:a(()=>[t(r(De)),e[15]||(e[15]=s(" 刷新 "))]),_:1,__:[15]}),t(C,{onClick:te},{default:a(()=>[t(r(Me)),e[16]||(e[16]=s(" 导出 "))]),_:1,__:[16]}),t(C,{type:"primary",onClick:ae},{default:a(()=>[t(r(Ye)),e[17]||(e[17]=s(" 新增角色 "))]),_:1,__:[17]})]),_:1})]),_:1})]),_:1})]),_:1}),t(S,{gutter:[16,16],class:"stats-cards"},{default:a(()=>[t(_,{xs:24,sm:12,md:6},{default:a(()=>[t(w,{class:"stat-card"},{default:a(()=>[t(R,{title:"总角色数",value:b.value.total,"value-style":{color:"#1890ff"}},{prefix:a(()=>[t(r(F))]),_:1},8,["value"])]),_:1})]),_:1}),t(_,{xs:24,sm:12,md:6},{default:a(()=>[t(w,{class:"stat-card"},{default:a(()=>[t(R,{title:"启用角色",value:b.value.active,"value-style":{color:"#52c41a"}},{prefix:a(()=>[t(r(Ie))]),_:1},8,["value"])]),_:1})]),_:1}),t(_,{xs:24,sm:12,md:6},{default:a(()=>[t(w,{class:"stat-card"},{default:a(()=>[t(R,{title:"系统角色",value:b.value.system,"value-style":{color:"#722ed1"}},{prefix:a(()=>[t(r(q))]),_:1},8,["value"])]),_:1})]),_:1}),t(_,{xs:24,sm:12,md:6},{default:a(()=>[t(w,{class:"stat-card"},{default:a(()=>[t(R,{title:"自定义角色",value:b.value.custom,"value-style":{color:"#fa8c16"}},{prefix:a(()=>[t(r(Ue))]),_:1},8,["value"])]),_:1})]),_:1})]),_:1}),t(S,{gutter:[16,16]},{default:a(()=>[t(_,{xs:24,lg:16},{default:a(()=>[t(w,{title:"角色列表",class:"role-table-card"},{extra:a(()=>[t(h,null,{default:a(()=>[t(C,{size:"small",onClick:pe,disabled:c.value.length===0},{default:a(()=>[t(r(je)),e[18]||(e[18]=s(" 批量启用 "))]),_:1,__:[18]},8,["disabled"]),t(P,null,{overlay:a(()=>[t(V,null,{default:a(()=>[t(g,{key:"1",onClick:me},{default:a(()=>e[20]||(e[20]=[s("批量禁用")])),_:1,__:[20]}),t(g,{key:"2",onClick:ve},{default:a(()=>e[21]||(e[21]=[s("批量导出")])),_:1,__:[21]}),t(g,{key:"3",onClick:fe},{default:a(()=>e[22]||(e[22]=[s("批量删除")])),_:1,__:[22]})]),_:1})]),default:a(()=>[t(C,{size:"small"},{default:a(()=>[e[19]||(e[19]=s(" 更多操作 ")),t(r(J))]),_:1,__:[19]})]),_:1})]),_:1})]),default:a(()=>[t(ke,{columns:Q,"data-source":W.value,pagination:T.value,loading:B.value,"row-selection":{selectedRowKeys:c.value,onChange:le},onChange:se,size:"small",bordered:""},{bodyCell:a(({column:i,record:n})=>[i.key==="name"?(f(),$("a",{key:0,onClick:y=>ne(n)},v(n.name),9,et)):i.key==="status"?(f(),M(D,{key:1,color:U(n.status)},{default:a(()=>[s(v(n.status),1)]),_:2},1032,["color"])):i.key==="type"?(f(),M(D,{key:2,color:I(n.type)},{default:a(()=>[s(v(n.type),1)]),_:2},1032,["color"])):i.key==="userCount"?(f(),$("a",{key:3,onClick:y=>ue(n)},v(n.userCount)+"人",9,tt)):i.key==="permissionCount"?(f(),$("a",{key:4,onClick:y=>ie(n)},v(n.permissionCount)+"项",9,at)):i.key==="createTime"?(f(),$(Ae,{key:5},[s(v(X(n.createTime)),1)],64)):i.key==="actions"?(f(),M(h,{key:6},{default:a(()=>[p("a",{onClick:y=>oe(n)},"编辑",8,lt),p("a",{onClick:y=>H(n)},"配置权限",8,st),p("a",{onClick:y=>A(n)},"分配用户",8,nt),t(P,null,{overlay:a(()=>[t(V,null,{default:a(()=>[t(g,{key:"1",onClick:y=>de(n)},{default:a(()=>e[24]||(e[24]=[s("复制角色")])),_:2,__:[24]},1032,["onClick"]),t(g,{key:"2",onClick:y=>_e(n)},{default:a(()=>e[25]||(e[25]=[s("导出角色")])),_:2,__:[25]},1032,["onClick"]),t(g,{key:"3",onClick:y=>K(n)},{default:a(()=>e[26]||(e[26]=[s("审计日志")])),_:2,__:[26]},1032,["onClick"]),t(ye),t(g,{key:"4",onClick:y=>re(n)},{default:a(()=>[s(v(n.status==="启用"?"禁用":"启用"),1)]),_:2},1032,["onClick"]),n.type!=="系统角色"?(f(),M(g,{key:"5",onClick:y=>ce(n),style:{color:"#ff4d4f"}},{default:a(()=>e[27]||(e[27]=[s(" 删除角色 ")])),_:2,__:[27]},1032,["onClick"])):G("",!0)]),_:2},1024)]),default:a(()=>[p("a",null,[e[23]||(e[23]=s(" 更多 ")),t(r(J))])]),_:2},1024)]),_:2},1024)):G("",!0)]),_:1},8,["data-source","pagination","loading","row-selection"])]),_:1})]),_:1}),t(_,{xs:24,lg:8},{default:a(()=>[t(w,{title:"角色详情",class:"role-detail-card"},{default:a(()=>[d.value?(f(),$("div",ot,[p("div",ut,[t(Ce,{size:64,style:qe({backgroundColor:I(d.value.type)})},{default:a(()=>[s(v(d.value.name.charAt(0)),1)]),_:1},8,["style"]),p("div",it,[p("h3",null,v(d.value.name),1),p("p",null,v(d.value.description),1),t(D,{color:U(d.value.status)},{default:a(()=>[s(v(d.value.status),1)]),_:1},8,["color"]),t(D,{color:I(d.value.type)},{default:a(()=>[s(v(d.value.type),1)]),_:1},8,["color"])])]),t(j),p("div",dt,[t(S,{gutter:16},{default:a(()=>[t(_,{span:12},{default:a(()=>[t(R,{title:"用户数量",value:d.value.userCount,suffix:"人"},null,8,["value"])]),_:1}),t(_,{span:12},{default:a(()=>[t(R,{title:"权限数量",value:d.value.permissionCount,suffix:"项"},null,8,["value"])]),_:1})]),_:1})]),t(j),p("div",_t,[t(h,{direction:"vertical",style:{width:"100%"}},{default:a(()=>[t(C,{type:"primary",block:"",onClick:e[3]||(e[3]=i=>H(d.value))},{default:a(()=>[t(r(q)),e[28]||(e[28]=s(" 配置权限 "))]),_:1,__:[28]}),t(C,{block:"",onClick:e[4]||(e[4]=i=>A(d.value))},{default:a(()=>[t(r(We)),e[29]||(e[29]=s(" 分配用户 "))]),_:1,__:[29]}),t(C,{block:"",onClick:e[5]||(e[5]=i=>K(d.value))},{default:a(()=>[t(r(Je)),e[30]||(e[30]=s(" 审计日志 "))]),_:1,__:[30]})]),_:1})])])):(f(),$("div",rt,[t(ge,{description:"请选择角色查看详情"})]))]),_:1})]),_:1})]),_:1})])}}},ft=xe(ct,[["__scopeId","data-v-d893e74d"]]);export{ft as default};
