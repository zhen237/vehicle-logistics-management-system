import{_ as be,r as y,a8 as v,a7 as K,o as Be,a as k,b as f,c as t,p as E,q as j,k as l,g as _,h as F,w as n,C as Te,d as Ae,e as d,f as Re,aj as Ne,j as Se,U as Ye,V as ze,B as Oe,ak as Pe,a2 as Me,P as Ue,S as Ke,ao as je,az as Fe,aB as Je,L as qe,x as Qe,y as We,t as r,s as Ge,A as He,z as J,aI as Xe,m as Ze,ae as q,W as Q,a3 as et,a4 as W,a5 as tt,a6 as at,ap as nt,aJ as lt,K as o}from"./index-Dk-eNI3p.js";const st={class:"driver-management"},it={class:"page-header"},ot=["onClick"],ut=["onClick"],dt=["onClick"],rt=["onClick"],_t={key:1,class:"text-muted"},ct=["onClick"],vt=["onClick"],ft=["onClick"],pt={__name:"Drivers",setup(yt){const D=y(""),I=y(""),L=y(""),$=y(""),A=y(!1),c=y([]),h=y({current:1,pageSize:10,total:0,showSizeChanger:!0,showQuickJumper:!0,showTotal:(a,e)=>`第 ${e[0]}-${e[1]} 条，共 ${a} 条`}),w=y([{id:"DRV001",employeeId:"E001",name:"张师傅",phone:"13800138001",status:"在岗",licenseType:"A2",licenseNumber:"110101199001011234",licenseExpiry:"2025-03-15",assignedVehicle:"京A12345",drivingYears:15,violationCount:0,lastCheckDate:"2024-01-15",emergencyContact:"李女士",emergencyPhone:"13800138002",avatar:"",key:"DRV001"},{id:"DRV002",employeeId:"E006",name:"李师傅",phone:"13800138003",status:"在岗",licenseType:"B2",licenseNumber:"110101198501011234",licenseExpiry:"2024-08-20",assignedVehicle:"沪C11111",drivingYears:12,violationCount:1,lastCheckDate:"2024-02-10",emergencyContact:"王先生",emergencyPhone:"13800138004",avatar:"",key:"DRV002"},{id:"DRV003",employeeId:"E007",name:"王师傅",phone:"13800138005",status:"休假",licenseType:"A1",licenseNumber:"110101197801011234",licenseExpiry:"2024-12-30",assignedVehicle:null,drivingYears:20,violationCount:0,lastCheckDate:"2023-12-05",emergencyContact:"张女士",emergencyPhone:"13800138006",avatar:"",key:"DRV003"},{id:"DRV004",employeeId:"E008",name:"赵师傅",phone:"13800138007",status:"在岗",licenseType:"B1",licenseNumber:"110101199201011234",licenseExpiry:"2025-06-10",assignedVehicle:"粤B88888",drivingYears:8,violationCount:2,lastCheckDate:"2024-03-20",emergencyContact:"刘先生",emergencyPhone:"13800138008",avatar:"",key:"DRV004"},{id:"DRV005",employeeId:"E009",name:"钱师傅",phone:"13800138009",status:"停岗",licenseType:"C1",licenseNumber:"110101199501011234",licenseExpiry:"2024-07-15",assignedVehicle:null,drivingYears:6,violationCount:3,lastCheckDate:"2024-01-30",emergencyContact:"孙女士",emergencyPhone:"13800138010",avatar:"",key:"DRV005"}]),b=y({total:w.value.length,active:w.value.filter(a=>a.status==="在岗").length,violations:w.value.reduce((a,e)=>a+e.violationCount,0),expiring:w.value.filter(a=>v(a.licenseExpiry).diff(v(),"day")<=60).length}),Y=K(()=>w.value.filter(a=>v(a.licenseExpiry).diff(v(),"day")<=60).map(a=>({...a,driverName:a.name,daysLeft:v(a.licenseExpiry).diff(v(),"day"),expiryDate:a.licenseExpiry})).sort((a,e)=>a.daysLeft-e.daysLeft)),G=[{title:"头像",dataIndex:"avatar",key:"avatar",width:80},{title:"姓名",dataIndex:"name",key:"name",width:100},{title:"工号",dataIndex:"employeeId",key:"employeeId",width:100},{title:"联系电话",dataIndex:"phone",key:"phone",width:130},{title:"状态",dataIndex:"status",key:"status",width:100},{title:"驾照类型",dataIndex:"licenseType",key:"licenseType",width:100},{title:"驾照到期",dataIndex:"licenseExpiry",key:"licenseExpiry",width:120},{title:"分配车辆",dataIndex:"assignedVehicle",key:"assignedVehicle",width:120},{title:"驾龄",dataIndex:"drivingYears",key:"drivingYears",width:80},{title:"违章次数",dataIndex:"violationCount",key:"violationCount",width:100},{title:"操作",key:"actions",width:250,fixed:"right"}],H=K(()=>{let a=w.value;if(D.value){const e=D.value.toLowerCase();a=a.filter(m=>m.name.toLowerCase().includes(e)||m.employeeId.toLowerCase().includes(e)||m.assignedVehicle&&m.assignedVehicle.toLowerCase().includes(e))}return I.value&&(a=a.filter(e=>e.status===I.value)),L.value&&(a=a.filter(e=>e.licenseType===L.value)),$.value&&($.value==="已分配"?a=a.filter(e=>e.assignedVehicle):$.value==="未分配"&&(a=a.filter(e=>!e.assignedVehicle))),h.value.total=a.length,a}),X=a=>{const e=["#f56a00","#7265e6","#ffbf00","#00a2ae","#87d068"],m=a.charCodeAt(0)%e.length;return e[m]},Z=a=>({在岗:"green",休假:"blue",停岗:"red",离职:"default"})[a]||"default",ee=a=>{if(!a)return!1;const e=v(a).diff(v(),"day");return e<=60&&e>0},te=a=>a?v(a).isBefore(v()):!1,z=a=>a?v(a).format("YYYY-MM-DD"):"-",ae=a=>{D.value=a,h.value.current=1},R=()=>{h.value.current=1},ne=()=>{A.value=!0,setTimeout(()=>{A.value=!1,o.success("数据已刷新")},1e3)},le=()=>{o.success("司机数据导出成功")},se=()=>{o.info("打开新增司机弹窗")},ie=a=>{c.value=a},oe=a=>{h.value={...h.value,...a}},ue=()=>{o.info("处理全部证件到期提醒")},de=a=>{o.info(`为司机 ${a.driverName} 办理驾驶证续期`)},re=a=>{o.info(`查看司机 ${a.driverName} 的驾驶证信息`)},_e=a=>{o.info(`查看司机详情: ${a.name}`)},ce=a=>{o.info(`编辑司机信息: ${a.name}`)},ve=a=>{o.info(`查看司机档案: ${a.name}`)},fe=a=>{o.info(`为司机 ${a.name} 分配车辆`)},pe=a=>{o.info(`查看司机 ${a.name} 的违章记录`)},ye=a=>{o.info(`查看司机 ${a.name} 的培训记录`)},me=a=>{o.info(`为司机 ${a.name} 安排体检`)},ge=a=>{o.info(`查看司机 ${a.name} 的绩效评估`)},ke=a=>{a.status="停岗",a.assignedVehicle=null,o.success(`司机 ${a.name} 已停岗`)},Ce=a=>{o.info(`查看车辆详情: ${a}`)},xe=()=>{o.info(`批量分配车辆给 ${c.value.length} 名司机`),c.value=[]},he=()=>{o.success(`批量导出 ${c.value.length} 名司机信息`),c.value=[]},we=()=>{o.info(`安排 ${c.value.length} 名司机参加培训`),c.value=[]},Ve=()=>{o.info(`安排 ${c.value.length} 名司机进行体检`),c.value=[]};return Be(()=>{}),(a,e)=>{const m=Ne,C=Re,u=ze,N=Ye,B=Se,V=Oe,O=Ae,x=Te,T=Ke,P=He,S=Ge,De=We,$e=Qe,Ee=qe,g=at,M=tt,U=et,Ie=nt,Le=Ze;return d(),k("div",st,[f("div",it,[f("h1",null,[t(_(F)),e[4]||(e[4]=l(" 司机管理 "))]),e[5]||(e[5]=f("p",null,"管理司机信息、驾驶证、违章记录，确保运输安全合规",-1))]),t(x,{class:"toolbar-card"},{default:n(()=>[t(O,{gutter:[16,16],align:"middle"},{default:n(()=>[t(C,{xs:24,sm:12,md:8},{default:n(()=>[t(m,{value:D.value,"onUpdate:value":e[0]||(e[0]=s=>D.value=s),placeholder:"搜索司机姓名、工号、车牌号",onSearch:ae,style:{width:"100%"}},null,8,["value"])]),_:1}),t(C,{xs:24,sm:12,md:8},{default:n(()=>[t(B,null,{default:n(()=>[t(N,{value:I.value,"onUpdate:value":e[1]||(e[1]=s=>I.value=s),placeholder:"司机状态",style:{width:"120px"},onChange:R},{default:n(()=>[t(u,{value:""},{default:n(()=>e[6]||(e[6]=[l("全部状态")])),_:1,__:[6]}),t(u,{value:"在岗"},{default:n(()=>e[7]||(e[7]=[l("在岗")])),_:1,__:[7]}),t(u,{value:"休假"},{default:n(()=>e[8]||(e[8]=[l("休假")])),_:1,__:[8]}),t(u,{value:"停岗"},{default:n(()=>e[9]||(e[9]=[l("停岗")])),_:1,__:[9]}),t(u,{value:"离职"},{default:n(()=>e[10]||(e[10]=[l("离职")])),_:1,__:[10]})]),_:1},8,["value"]),t(N,{value:L.value,"onUpdate:value":e[2]||(e[2]=s=>L.value=s),placeholder:"驾照类型",style:{width:"120px"},onChange:R},{default:n(()=>[t(u,{value:""},{default:n(()=>e[11]||(e[11]=[l("全部类型")])),_:1,__:[11]}),t(u,{value:"A1"},{default:n(()=>e[12]||(e[12]=[l("A1")])),_:1,__:[12]}),t(u,{value:"A2"},{default:n(()=>e[13]||(e[13]=[l("A2")])),_:1,__:[13]}),t(u,{value:"B1"},{default:n(()=>e[14]||(e[14]=[l("B1")])),_:1,__:[14]}),t(u,{value:"B2"},{default:n(()=>e[15]||(e[15]=[l("B2")])),_:1,__:[15]}),t(u,{value:"C1"},{default:n(()=>e[16]||(e[16]=[l("C1")])),_:1,__:[16]})]),_:1},8,["value"]),t(N,{value:$.value,"onUpdate:value":e[3]||(e[3]=s=>$.value=s),placeholder:"分配车辆",style:{width:"120px"},onChange:R},{default:n(()=>[t(u,{value:""},{default:n(()=>e[17]||(e[17]=[l("全部车辆")])),_:1,__:[17]}),t(u,{value:"已分配"},{default:n(()=>e[18]||(e[18]=[l("已分配")])),_:1,__:[18]}),t(u,{value:"未分配"},{default:n(()=>e[19]||(e[19]=[l("未分配")])),_:1,__:[19]})]),_:1},8,["value"])]),_:1})]),_:1}),t(C,{xs:24,sm:24,md:8,class:"text-right"},{default:n(()=>[t(B,null,{default:n(()=>[t(V,{onClick:ne},{default:n(()=>[t(_(Pe)),e[20]||(e[20]=l(" 刷新 "))]),_:1,__:[20]}),t(V,{onClick:le},{default:n(()=>[t(_(Me)),e[21]||(e[21]=l(" 导出 "))]),_:1,__:[21]}),t(V,{type:"primary",onClick:se},{default:n(()=>[t(_(Ue)),e[22]||(e[22]=l(" 新增司机 "))]),_:1,__:[22]})]),_:1})]),_:1})]),_:1})]),_:1}),t(O,{gutter:[16,16],class:"stats-cards"},{default:n(()=>[t(C,{xs:24,sm:12,md:6},{default:n(()=>[t(x,{class:"stat-card"},{default:n(()=>[t(T,{title:"总司机数",value:b.value.total,"value-style":{color:"#1890ff"}},{prefix:n(()=>[t(_(F))]),_:1},8,["value"])]),_:1})]),_:1}),t(C,{xs:24,sm:12,md:6},{default:n(()=>[t(x,{class:"stat-card"},{default:n(()=>[t(T,{title:"在岗司机",value:b.value.active,"value-style":{color:"#52c41a"}},{prefix:n(()=>[t(_(je))]),_:1},8,["value"])]),_:1})]),_:1}),t(C,{xs:24,sm:12,md:6},{default:n(()=>[t(x,{class:"stat-card"},{default:n(()=>[t(T,{title:"违章待处理",value:b.value.violations,"value-style":{color:"#fa8c16"}},{prefix:n(()=>[t(_(Fe))]),_:1},8,["value"])]),_:1})]),_:1}),t(C,{xs:24,sm:12,md:6},{default:n(()=>[t(x,{class:"stat-card"},{default:n(()=>[t(T,{title:"证件即将到期",value:b.value.expiring,"value-style":{color:"#ff4d4f"}},{prefix:n(()=>[t(_(Je))]),_:1},8,["value"])]),_:1})]),_:1})]),_:1}),Y.value.length>0?(d(),E(x,{key:0,title:"证件到期提醒",class:"reminder-card"},{extra:n(()=>[t(V,{size:"small",onClick:ue},{default:n(()=>e[23]||(e[23]=[l(" 处理全部 ")])),_:1,__:[23]})]),default:n(()=>[t(Ee,{"data-source":Y.value,size:"small"},{renderItem:n(({item:s})=>[t($e,null,{actions:n(()=>[f("a",{onClick:i=>de(s)},"续期",8,ot),f("a",{onClick:i=>re(s)},"查看",8,ut)]),default:n(()=>[t(De,null,{avatar:n(()=>[t(P,{style:J({backgroundColor:s.daysLeft<=30?"#ff4d4f":"#faad14"})},{default:n(()=>[t(_(Xe))]),_:2},1032,["style"])]),title:n(()=>[f("span",null,r(s.driverName)+" - "+r(s.licenseType)+"驾驶证",1),t(S,{color:s.daysLeft<=30?"red":"orange",class:"ml-2"},{default:n(()=>[l(r(s.daysLeft<=0?"已过期":`${s.daysLeft}天后到期`),1)]),_:2},1032,["color"])]),description:n(()=>[l(" 驾驶证号："+r(s.licenseNumber)+" | 到期日期："+r(z(s.expiryDate)),1)]),_:2},1024)]),_:2},1024)]),_:1},8,["data-source"])]),_:1})):j("",!0),t(x,{title:"司机列表",class:"driver-table-card"},{extra:n(()=>[t(B,null,{default:n(()=>[t(V,{size:"small",onClick:xe,disabled:c.value.length===0},{default:n(()=>[t(_(lt)),e[24]||(e[24]=l(" 批量分配车辆 "))]),_:1,__:[24]},8,["disabled"]),t(U,null,{overlay:n(()=>[t(M,null,{default:n(()=>[t(g,{key:"1",onClick:he},{default:n(()=>e[26]||(e[26]=[l("批量导出")])),_:1,__:[26]}),t(g,{key:"2",onClick:we},{default:n(()=>e[27]||(e[27]=[l("批量培训")])),_:1,__:[27]}),t(g,{key:"3",onClick:Ve},{default:n(()=>e[28]||(e[28]=[l("批量体检")])),_:1,__:[28]})]),_:1})]),default:n(()=>[t(V,{size:"small"},{default:n(()=>[e[25]||(e[25]=l(" 更多操作 ")),t(_(W))]),_:1,__:[25]})]),_:1})]),_:1})]),default:n(()=>[t(Le,{columns:G,"data-source":H.value,pagination:h.value,loading:A.value,"row-selection":{selectedRowKeys:c.value,onChange:ie},onChange:oe,size:"small",bordered:""},{bodyCell:n(({column:s,record:i})=>[s.key==="avatar"?(d(),E(P,{key:0,src:i.avatar,style:J({backgroundColor:X(i.name)})},{default:n(()=>[l(r(i.name.charAt(0)),1)]),_:2},1032,["src","style"])):s.key==="name"?(d(),k("a",{key:1,onClick:p=>_e(i)},r(i.name),9,dt)):s.key==="status"?(d(),E(S,{key:2,color:Z(i.status)},{default:n(()=>[l(r(i.status),1)]),_:2},1032,["color"])):s.key==="licenseType"?(d(),E(S,{key:3,color:"blue"},{default:n(()=>[l(r(i.licenseType),1)]),_:2},1024)):s.key==="licenseExpiry"?(d(),k("span",{key:4,class:q({"text-warning":ee(i.licenseExpiry),"text-danger":te(i.licenseExpiry)})},r(z(i.licenseExpiry)),3)):s.key==="assignedVehicle"?(d(),k(Q,{key:5},[i.assignedVehicle?(d(),k("a",{key:0,onClick:p=>Ce(i.assignedVehicle)},r(i.assignedVehicle),9,rt)):(d(),k("span",_t,"未分配"))],64)):s.key==="drivingYears"?(d(),k(Q,{key:6},[l(r(i.drivingYears)+"年 ",1)],64)):s.key==="violationCount"?(d(),k("span",{key:7,class:q({"text-danger":i.violationCount>0})},r(i.violationCount),3)):s.key==="actions"?(d(),E(B,{key:8},{default:n(()=>[f("a",{onClick:p=>ce(i)},"编辑",8,ct),f("a",{onClick:p=>ve(i)},"档案",8,vt),f("a",{onClick:p=>fe(i)},"分配车辆",8,ft),t(U,null,{overlay:n(()=>[t(M,null,{default:n(()=>[t(g,{key:"1",onClick:p=>pe(i)},{default:n(()=>e[30]||(e[30]=[l("违章记录")])),_:2,__:[30]},1032,["onClick"]),t(g,{key:"2",onClick:p=>ye(i)},{default:n(()=>e[31]||(e[31]=[l("培训记录")])),_:2,__:[31]},1032,["onClick"]),t(g,{key:"3",onClick:p=>me(i)},{default:n(()=>e[32]||(e[32]=[l("安排体检")])),_:2,__:[32]},1032,["onClick"]),t(g,{key:"4",onClick:p=>ge(i)},{default:n(()=>e[33]||(e[33]=[l("绩效评估")])),_:2,__:[33]},1032,["onClick"]),t(Ie),t(g,{key:"5",onClick:p=>ke(i),style:{color:"#ff4d4f"}},{default:n(()=>e[34]||(e[34]=[l("停岗处理")])),_:2,__:[34]},1032,["onClick"])]),_:2},1024)]),default:n(()=>[f("a",null,[e[29]||(e[29]=l(" 更多 ")),t(_(W))])]),_:2},1024)]),_:2},1024)):j("",!0)]),_:1},8,["data-source","pagination","loading","row-selection"])]),_:1})])}}},gt=be(pt,[["__scopeId","data-v-a8a1579f"]]);export{gt as default};
