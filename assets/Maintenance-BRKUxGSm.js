import{_ as he,r as f,a8 as x,a7 as $e,o as be,a as h,b as p,c as t,p as I,q as R,k as l,g as d,ax as F,w as a,C as De,d as Ne,e as v,f as Be,aj as Oe,j as Se,U as Ie,V as Ye,B as ze,ak as Re,a2 as Te,P as Ee,S as Ae,ay as Le,O as Ve,az as Ue,L as Fe,x as Ke,y as je,t as m,s as Pe,A as qe,z as Je,m as Qe,W as K,ae as We,a3 as Ge,a4 as j,a5 as He,a6 as Xe,ap as Ze,ag as et,K as i}from"./index-Dk-eNI3p.js";import{m as tt}from"./mockData-_Udtor0Z.js";import{E as at}from"./ExclamationOutlined-Ciss07O4.js";const nt={class:"maintenance-management"},lt={class:"page-header"},st=["onClick"],ot=["onClick"],it=["onClick"],ut=["onClick"],dt=["onClick"],_t=["onClick"],ct={__name:"Maintenance",setup(rt){const $=f(""),D=f(""),N=f(""),Y=f(!1),u=f([]),w=f({current:1,pageSize:10,total:0,showSizeChanger:!0,showQuickJumper:!0,showTotal:(n,e)=>`第 ${e[0]}-${e[1]} 条，共 ${n} 条`}),_=f(tt.map((n,e)=>({...n,key:n.id,status:e%4===0?"已完成":e%4===1?"维修中":e%4===2?"待维修":"已取消"}))),B=f({total:_.value.length,thisMonth:_.value.filter(n=>x(n.maintenanceDate).format("YYYY-MM")===x().format("YYYY-MM")).length,totalCost:_.value.reduce((n,e)=>n+e.cost,0),pending:_.value.filter(n=>n.status==="待维修").length}),b=f([{id:1,title:"车辆京A12345需要定期保养",description:"该车辆已行驶8000公里，需要进行定期保养",level:"urgent",vehicleNumber:"京A12345"},{id:2,title:"车辆沪C11111保险即将到期",description:"该车辆保险将在7天后到期，请及时续保",level:"normal",vehicleNumber:"沪C11111"},{id:3,title:"车辆粤B88888年检到期",description:"该车辆年检已到期，请尽快安排年检",level:"urgent",vehicleNumber:"粤B88888"}]),P=[{title:"车牌号",dataIndex:"vehicleNumber",key:"vehicleNumber",width:120},{title:"维修类型",dataIndex:"type",key:"type",width:100},{title:"维修项目",dataIndex:"items",key:"items",width:200},{title:"维修状态",dataIndex:"status",key:"status",width:100},{title:"维修费用",dataIndex:"cost",key:"cost",width:120},{title:"技师",dataIndex:"technician",key:"technician",width:100},{title:"维修日期",dataIndex:"maintenanceDate",key:"maintenanceDate",width:120},{title:"下次保养",dataIndex:"nextMaintenanceDate",key:"nextMaintenanceDate",width:120},{title:"操作",key:"actions",width:200,fixed:"right"}],q=$e(()=>{let n=_.value;if($.value){const e=$.value.toLowerCase();n=n.filter(c=>c.vehicleNumber.toLowerCase().includes(e)||c.items.toLowerCase().includes(e))}return D.value&&(n=n.filter(e=>e.type===D.value)),N.value&&(n=n.filter(e=>e.status===N.value)),w.value.total=n.length,n}),J=n=>({定期保养:"blue",故障维修:"orange",紧急维修:"red",年检:"green"})[n]||"default",Q=n=>({待维修:"orange",维修中:"blue",已完成:"green",已取消:"red"})[n]||"default",T=n=>n?x(n).format("YYYY-MM-DD"):"-",W=n=>{if(!n)return!1;const e=x(n).diff(x(),"day");return e<=7&&e>0},G=n=>n?x(n).isBefore(x()):!1,H=n=>{$.value=n,w.value.current=1},E=()=>{w.value.current=1},X=()=>{Y.value=!0,setTimeout(()=>{Y.value=!1,i.success("数据已刷新")},1e3)},Z=()=>{i.success("维修数据导出成功")},ee=()=>{i.info("打开新增维修弹窗")},te=n=>{u.value=n},ae=n=>{w.value={...w.value,...n}},ne=n=>{i.info(`处理提醒: ${n.title}`)},le=n=>{const e=b.value.findIndex(c=>c.id===n.id);e>-1&&(b.value.splice(e,1),i.success("已忽略该提醒"))},se=()=>{b.value=[],i.success("已处理全部提醒")},oe=n=>{i.info(`查看车辆详情: ${n.vehicleNumber}`)},ie=n=>{i.info(`编辑维修记录: ${n.id}`)},ue=n=>{i.info(`查看维修记录: ${n.id}`)},de=n=>{n.status="已完成",i.success(`维修记录 ${n.id} 已完成`)},_e=n=>{i.success(`维修单据 ${n.id} 打印成功`)},ce=n=>{i.success(`维修记录 ${n.id} 已复制`)},re=n=>{i.info(`为维修记录 ${n.id} 添加跟进`)},ve=n=>{const e=_.value.findIndex(c=>c.id===n.id);e>-1&&(_.value.splice(e,1),i.success("维修记录删除成功"))},fe=()=>{u.value.forEach(n=>{const e=_.value.find(c=>c.key===n);e&&(e.status="已完成")}),i.success(`已完成 ${u.value.length} 条维修记录`),u.value=[]},pe=()=>{i.success(`批量导出 ${u.value.length} 条维修记录`),u.value=[]},me=()=>{i.success(`批量打印 ${u.value.length} 条维修记录`),u.value=[]},ke=()=>{_.value=_.value.filter(n=>!u.value.includes(n.key)),i.success(`已删除 ${u.value.length} 条维修记录`),u.value=[]};return be(()=>{}),(n,e)=>{const c=Oe,k=Be,r=Ye,A=Ie,O=Se,M=ze,L=Ne,y=De,S=Ae,ye=qe,z=Pe,ge=je,Ce=Ke,xe=Fe,g=Xe,V=He,U=Ge,we=Ze,Me=Qe;return v(),h("div",nt,[p("div",lt,[p("h1",null,[t(d(F)),e[3]||(e[3]=l(" 维修保养 "))]),e[4]||(e[4]=p("p",null,"管理车辆维修保养记录，确保车辆安全运行，延长使用寿命",-1))]),t(y,{class:"toolbar-card"},{default:a(()=>[t(L,{gutter:[16,16],align:"middle"},{default:a(()=>[t(k,{xs:24,sm:12,md:8},{default:a(()=>[t(c,{value:$.value,"onUpdate:value":e[0]||(e[0]=s=>$.value=s),placeholder:"搜索车牌号、维修项目",onSearch:H,style:{width:"100%"}},null,8,["value"])]),_:1}),t(k,{xs:24,sm:12,md:8},{default:a(()=>[t(O,null,{default:a(()=>[t(A,{value:D.value,"onUpdate:value":e[1]||(e[1]=s=>D.value=s),placeholder:"维修类型",style:{width:"120px"},onChange:E},{default:a(()=>[t(r,{value:""},{default:a(()=>e[5]||(e[5]=[l("全部类型")])),_:1,__:[5]}),t(r,{value:"定期保养"},{default:a(()=>e[6]||(e[6]=[l("定期保养")])),_:1,__:[6]}),t(r,{value:"故障维修"},{default:a(()=>e[7]||(e[7]=[l("故障维修")])),_:1,__:[7]}),t(r,{value:"紧急维修"},{default:a(()=>e[8]||(e[8]=[l("紧急维修")])),_:1,__:[8]}),t(r,{value:"年检"},{default:a(()=>e[9]||(e[9]=[l("年检")])),_:1,__:[9]})]),_:1},8,["value"]),t(A,{value:N.value,"onUpdate:value":e[2]||(e[2]=s=>N.value=s),placeholder:"维修状态",style:{width:"120px"},onChange:E},{default:a(()=>[t(r,{value:""},{default:a(()=>e[10]||(e[10]=[l("全部状态")])),_:1,__:[10]}),t(r,{value:"待维修"},{default:a(()=>e[11]||(e[11]=[l("待维修")])),_:1,__:[11]}),t(r,{value:"维修中"},{default:a(()=>e[12]||(e[12]=[l("维修中")])),_:1,__:[12]}),t(r,{value:"已完成"},{default:a(()=>e[13]||(e[13]=[l("已完成")])),_:1,__:[13]}),t(r,{value:"已取消"},{default:a(()=>e[14]||(e[14]=[l("已取消")])),_:1,__:[14]})]),_:1},8,["value"])]),_:1})]),_:1}),t(k,{xs:24,sm:24,md:8,class:"text-right"},{default:a(()=>[t(O,null,{default:a(()=>[t(M,{onClick:X},{default:a(()=>[t(d(Re)),e[15]||(e[15]=l(" 刷新 "))]),_:1,__:[15]}),t(M,{onClick:Z},{default:a(()=>[t(d(Te)),e[16]||(e[16]=l(" 导出 "))]),_:1,__:[16]}),t(M,{type:"primary",onClick:ee},{default:a(()=>[t(d(Ee)),e[17]||(e[17]=l(" 新增维修 "))]),_:1,__:[17]})]),_:1})]),_:1})]),_:1})]),_:1}),t(L,{gutter:[16,16],class:"stats-cards"},{default:a(()=>[t(k,{xs:24,sm:12,md:6},{default:a(()=>[t(y,{class:"stat-card"},{default:a(()=>[t(S,{title:"总维修次数",value:B.value.total,"value-style":{color:"#1890ff"}},{prefix:a(()=>[t(d(F))]),_:1},8,["value"])]),_:1})]),_:1}),t(k,{xs:24,sm:12,md:6},{default:a(()=>[t(y,{class:"stat-card"},{default:a(()=>[t(S,{title:"本月维修",value:B.value.thisMonth,"value-style":{color:"#52c41a"}},{prefix:a(()=>[t(d(Le))]),_:1},8,["value"])]),_:1})]),_:1}),t(k,{xs:24,sm:12,md:6},{default:a(()=>[t(y,{class:"stat-card"},{default:a(()=>[t(S,{title:"维修费用",value:B.value.totalCost,"value-style":{color:"#722ed1"},formatter:s=>`¥${(s/1e4).toFixed(1)}万`},{prefix:a(()=>[t(d(Ve))]),_:1},8,["value","formatter"])]),_:1})]),_:1}),t(k,{xs:24,sm:12,md:6},{default:a(()=>[t(y,{class:"stat-card"},{default:a(()=>[t(S,{title:"待维修车辆",value:B.value.pending,"value-style":{color:"#fa8c16"}},{prefix:a(()=>[t(d(Ue))]),_:1},8,["value"])]),_:1})]),_:1})]),_:1}),b.value.length>0?(v(),I(y,{key:0,title:"维修提醒",class:"reminder-card"},{extra:a(()=>[t(M,{size:"small",onClick:se},{default:a(()=>e[18]||(e[18]=[l(" 处理全部 ")])),_:1,__:[18]})]),default:a(()=>[t(xe,{"data-source":b.value,size:"small"},{renderItem:a(({item:s})=>[t(Ce,null,{actions:a(()=>[p("a",{onClick:o=>ne(s)},"处理",8,st),p("a",{onClick:o=>le(s)},"忽略",8,ot)]),default:a(()=>[t(ge,null,{avatar:a(()=>[t(ye,{style:Je({backgroundColor:s.level==="urgent"?"#ff4d4f":"#faad14"})},{default:a(()=>[t(d(at))]),_:2},1032,["style"])]),title:a(()=>[p("span",null,m(s.title),1),t(z,{color:s.level==="urgent"?"red":"orange",class:"ml-2"},{default:a(()=>[l(m(s.level==="urgent"?"紧急":"提醒"),1)]),_:2},1032,["color"])]),description:a(()=>[l(m(s.description),1)]),_:2},1024)]),_:2},1024)]),_:1},8,["data-source"])]),_:1})):R("",!0),t(y,{title:"维修记录",class:"maintenance-table-card"},{extra:a(()=>[t(O,null,{default:a(()=>[t(M,{size:"small",onClick:fe,disabled:u.value.length===0},{default:a(()=>[t(d(et)),e[19]||(e[19]=l(" 批量完成 "))]),_:1,__:[19]},8,["disabled"]),t(U,null,{overlay:a(()=>[t(V,null,{default:a(()=>[t(g,{key:"1",onClick:pe},{default:a(()=>e[21]||(e[21]=[l("批量导出")])),_:1,__:[21]}),t(g,{key:"2",onClick:me},{default:a(()=>e[22]||(e[22]=[l("批量打印")])),_:1,__:[22]}),t(g,{key:"3",onClick:ke},{default:a(()=>e[23]||(e[23]=[l("批量删除")])),_:1,__:[23]})]),_:1})]),default:a(()=>[t(M,{size:"small"},{default:a(()=>[e[20]||(e[20]=l(" 更多操作 ")),t(d(j))]),_:1,__:[20]})]),_:1})]),_:1})]),default:a(()=>[t(Me,{columns:P,"data-source":q.value,pagination:w.value,loading:Y.value,"row-selection":{selectedRowKeys:u.value,onChange:te},onChange:ae,size:"small",bordered:""},{bodyCell:a(({column:s,record:o})=>[s.key==="vehicleNumber"?(v(),h("a",{key:0,onClick:C=>oe(o)},m(o.vehicleNumber),9,it)):s.key==="type"?(v(),I(z,{key:1,color:J(o.type)},{default:a(()=>[l(m(o.type),1)]),_:2},1032,["color"])):s.key==="status"?(v(),I(z,{key:2,color:Q(o.status)},{default:a(()=>[l(m(o.status),1)]),_:2},1032,["color"])):s.key==="cost"?(v(),h(K,{key:3},[l(" ¥"+m(o.cost.toLocaleString()),1)],64)):s.key==="maintenanceDate"?(v(),h(K,{key:4},[l(m(T(o.maintenanceDate)),1)],64)):s.key==="nextMaintenanceDate"?(v(),h("span",{key:5,class:We({"text-warning":W(o.nextMaintenanceDate),"text-danger":G(o.nextMaintenanceDate)})},m(T(o.nextMaintenanceDate)),3)):s.key==="actions"?(v(),I(O,{key:6},{default:a(()=>[p("a",{onClick:C=>ie(o)},"编辑",8,ut),p("a",{onClick:C=>ue(o)},"查看",8,dt),o.status!=="已完成"?(v(),h("a",{key:0,onClick:C=>de(o)},"完成",8,_t)):R("",!0),t(U,null,{overlay:a(()=>[t(V,null,{default:a(()=>[t(g,{key:"1",onClick:C=>_e(o)},{default:a(()=>e[25]||(e[25]=[l("打印单据")])),_:2,__:[25]},1032,["onClick"]),t(g,{key:"2",onClick:C=>ce(o)},{default:a(()=>e[26]||(e[26]=[l("复制记录")])),_:2,__:[26]},1032,["onClick"]),t(g,{key:"3",onClick:C=>re(o)},{default:a(()=>e[27]||(e[27]=[l("添加跟进")])),_:2,__:[27]},1032,["onClick"]),t(we),t(g,{key:"4",onClick:C=>ve(o),style:{color:"#ff4d4f"}},{default:a(()=>e[28]||(e[28]=[l("删除记录")])),_:2,__:[28]},1032,["onClick"])]),_:2},1024)]),default:a(()=>[p("a",null,[e[24]||(e[24]=l(" 更多 ")),t(d(j))])]),_:2},1024)]),_:2},1024)):R("",!0)]),_:1},8,["data-source","pagination","loading","row-selection"])]),_:1})])}}},mt=he(ct,[["__scopeId","data-v-c4747549"]]);export{mt as default};
